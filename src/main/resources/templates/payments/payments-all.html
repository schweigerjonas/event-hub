<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">

<main layout:fragment="main">
    <div class="container mt-4">
        <h1 class="mb-4 text-center">Meine Zahlungen</h1>

        <form th:action="@{/payments/pdf}" method="get" th:if="${!#lists.isEmpty(payments)}">
            <button type="submit" class="btn btn-primary mb-3">
                Zahlungen als PDF herunterladen
            </button>
        </form>

        <div th:if="${#lists.isEmpty(payments)}">
            Keine Zahlungen vorhanden
        </div>

        <ul class="list-group" th:if="${!#lists.isEmpty(payments)}">
            <li class="list-group-item d-flex justify-content-between align-items-center mb-2" th:each="payment : ${payments}">
                <div>
                    <strong th:text="${payment.event.name}"></strong><br>
                    <small class="text-muted">Betrag: <span th:text="${payment.amount}"></span> â‚¬</small><br>
                    <small class="text-muted">Bezahlt am: <span th:text="${#temporals.format(payment.timestamp, 'dd.MM.yyyy HH:mm')}"></span></small><br>
                    <small class="text-muted">Transaktions-ID (PayPal): <span th:text="${payment.paypalTransactionId}"></span></small>
                </div>

                <div>
                    <div class="btn btn-success btn-sm" th:if="${payment.status.toString() == 'COMPLETED'}">
                        erfolgreich
                    </div>
                    <div class="btn btn-danger btn-sm" th:if="${payment.status.toString() == 'FAILED'}">
                        fehlgeschlagen
                    </div>
                </div>
            </li>
        </ul>
    </div>
</main>
</html>
